"use strict";const e=require("vue"),a=require("./useDefaults-DA3S59IE.js"),l=require("./index-CHhN7c8p.js"),o=require("./useSafeScrollLock-D3JC70eX.js"),t=require("./classes-CXBJXuVd.js"),r=require("./BButton.vue_vue_type_script_setup_true_lang-CE6qvsTI.js"),n=require("./BCloseButton.vue_vue_type_script_setup_true_lang-DN7lP-29.js"),d=require("./useId-C1J_udPo.js"),u=require("./dom-BUc9qVuq.js"),s=require("./useColorVariantClasses-CE658Sm0.js"),i=require("./useModalManager-CGq3rVoj.js"),c=require("./ConditionalTeleport.vue_vue_type_script_lang-IRCRuUE1.js"),f=require("./_plugin-vue_export-helper-CC_fc8JW.js"),p=require("./src/composables/useModalController/index.umd.js"),v=["id","aria-labelledby","aria-describedby"],m=["id"],y="modal-fallback-focus",k=e.defineComponent({inheritAttrs:!1,__name:"BModal",props:e.mergeModels({autofocus:{type:Boolean,default:!0},autofocusButton:{default:void 0},body:{default:void 0},bodyAttrs:{default:void 0},bodyBgVariant:{default:null},bodyClass:{default:null},bodyScrolling:{type:Boolean,default:!1},bodyTextVariant:{default:null},bodyVariant:{default:null},busy:{type:Boolean,default:!1},buttonSize:{default:"md"},cancelDisabled:{type:Boolean,default:!1},cancelTitle:{default:"Cancel"},cancelVariant:{default:"secondary"},centered:{type:Boolean,default:!1},contentClass:{default:void 0},dialogClass:{default:void 0},footerBgVariant:{default:null},footerBorderVariant:{default:null},footerClass:{default:void 0},footerTextVariant:{default:null},footerVariant:{default:null},fullscreen:{type:[Boolean,String],default:!1},headerBgVariant:{default:null},headerBorderVariant:{default:null},headerClass:{default:void 0},headerCloseClass:{default:void 0},headerCloseLabel:{default:"Close"},headerCloseVariant:{default:"secondary"},headerTextVariant:{default:null},headerVariant:{default:null},hideBackdrop:{type:Boolean,default:!1},hideFooter:{type:Boolean,default:!1},hideHeader:{type:Boolean,default:!1},hideHeaderClose:{type:Boolean,default:!1},id:{default:void 0},lazy:{type:Boolean,default:!1},modalClass:{default:void 0},noCloseOnBackdrop:{type:Boolean,default:!1},noCloseOnEsc:{type:Boolean,default:!1},noFade:{type:Boolean,default:!1},noTrap:{type:Boolean,default:!1},noStacking:{type:Boolean},okDisabled:{type:Boolean,default:!1},okOnly:{type:Boolean,default:!1},okTitle:{default:"OK"},okVariant:{default:"primary"},scrollable:{type:Boolean,default:!1},size:{default:"md"},title:{default:void 0},titleClass:{default:void 0},titleVisuallyHidden:{type:Boolean,default:!1},titleTag:{default:"h5"},transProps:{default:void 0},teleportDisabled:{type:Boolean,default:!1},teleportTo:{default:"body"}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:e.mergeModels(["backdrop","cancel","close","esc","hidden","hide","hide-prevented","ok","show","show-prevented","shown"],["update:modelValue"]),setup(f,{expose:p,emit:k}){const B=f,b=a.useDefaults(B,"BModal"),h=k,C=e.useSlots(),V=d.useId((()=>b.id),"modal"),g=e.useModel(f,"modelValue"),_=e.ref(null),x=e.ref(null),z=e.ref(null),S=e.ref(null),w=e.ref(null),T=e.ref(!1),P=e.ref(!1),{needsFallback:E}=o.useActivatedFocusTrap({element:_,isActive:T,noTrap:()=>b.noTrap,fallbackFocus:{ref:x,classSelector:y}});l.onKeyStroke("Escape",(()=>{Z("esc")}),{target:_}),o.useSafeScrollLock(g,(()=>b.bodyScrolling));const{focused:D}=l.useFocus(_,{initialValue:g.value&&void 0===b.autofocusButton&&!0===b.autofocus}),{focused:N}=l.useFocus(z,{initialValue:g.value&&"ok"===b.autofocusButton&&!0===b.autofocus}),{focused:M}=l.useFocus(S,{initialValue:g.value&&"cancel"===b.autofocusButton&&!0===b.autofocus}),{focused:F}=l.useFocus(w,{initialValue:g.value&&"close"===b.autofocusButton&&!0===b.autofocus}),$=e.computed((()=>[b.modalClass,{fade:!b.noFade,show:T.value}])),q=e.computed((()=>!1===b.lazy||!0===b.lazy&&!0===P.value||!0===b.lazy&&!0===g.value)),j=e.computed((()=>!u.isEmptySlot(C["header-close"]))),H=e.computed((()=>[b.dialogClass,{"modal-fullscreen":!0===b.fullscreen,[`modal-fullscreen-${b.fullscreen}-down`]:"string"==typeof b.fullscreen,[`modal-${b.size}`]:"md"!==b.size,"modal-dialog-centered":b.centered,"modal-dialog-scrollable":b.scrollable}])),L=s.useColorVariantClasses((()=>({bgVariant:b.bodyBgVariant,textVariant:b.bodyTextVariant,variant:b.bodyVariant}))),A=e.computed((()=>[b.bodyClass,L.value])),O=s.useColorVariantClasses((()=>({bgVariant:b.headerBgVariant,textVariant:b.headerTextVariant,variant:b.headerVariant,borderVariant:b.headerBorderVariant}))),R=e.computed((()=>[b.headerClass,O.value])),I=e.computed((()=>({variant:j.value?b.headerCloseVariant:void 0,class:b.headerCloseClass}))),K=s.useColorVariantClasses((()=>({bgVariant:b.footerBgVariant,textVariant:b.footerTextVariant,variant:b.footerVariant,borderVariant:b.footerBorderVariant}))),U=e.computed((()=>[b.footerClass,K.value])),W=e.computed((()=>[b.titleClass,{"visually-hidden":b.titleVisuallyHidden}])),X=e.computed((()=>b.cancelDisabled||b.busy)),Y=e.computed((()=>b.okDisabled||b.busy)),G=(e,a={})=>new t.BvTriggerableEvent(e,{cancelable:!1,target:_.value||null,relatedTarget:null,trigger:null,...a,componentId:V.value}),J=e=>{e&&e.classList.add("show")},Q=e=>{e&&e.classList.remove("show")};e.watch(g,((e,a)=>{e!==a&&(!0===e?ee():Z())}));const Z=(e="")=>{if("backdrop"===e&&b.noCloseOnBackdrop||"esc"===e&&b.noCloseOnEsc)return void h("hide-prevented");const a=G("hide",{cancelable:""!==e,trigger:e});if("ok"===e&&h(e,a),"cancel"===e&&h(e,a),"close"===e&&h(e,a),"backdrop"===e&&h(e,a),"esc"===e&&h(e,a),h("hide",a),a.defaultPrevented)return h("hide-prevented"),void(g.value||(g.value=!0));g.value&&(g.value=!1)},ee=()=>{if(T.value)return;const e=G("show",{cancelable:!0});if(h("show",e),e.defaultPrevented)return g.value&&(g.value=!1),void h("show-prevented");g.value||(g.value=!0)},ae=()=>{ee()},le=e=>{J(e),T.value=!0,!1!==b.autofocus&&("ok"===b.autofocusButton?N.value=!0:"close"===b.autofocusButton?F.value=!0:"cancel"===b.autofocusButton?M.value=!0:D.value=!0),h("shown",G("shown")),!0===b.lazy&&(P.value=!0)},oe=e.ref(!1),te=()=>{T.value=!1,oe.value=!0},re=e=>{h("hidden",G("hidden")),!0===b.lazy&&(P.value=!1),oe.value=!1,Q(e)},{activePosition:ne,activeModalCount:de,stackWithoutSelf:ue}=i.useModalManager(T,g.value);e.watch(ue,((e,a)=>{e.length>a.length&&!0===T.value&&!0===b.noStacking&&Z()}));const se=e.computed((()=>T.value||oe.value?1056-(2*((null==de?void 0:de.value)??0)-2*((null==ne?void 0:ne.value)??0)):1056)),ie=e.computed((()=>({"z-index":se.value}))),ce=e.computed((()=>({"z-index":se.value-1})));l.useEventListener(_,"bv-toggle",(()=>{g.value?Z():ee()}));const fe=e.computed((()=>({cancel:()=>{Z("cancel")},close:()=>{Z("close")},hide:Z,ok:()=>{Z("ok")},active:T.value,visible:g.value})));return p({hide:Z,id:V,show:ee}),(a,l)=>(e.openBlock(),e.createBlock(c._sfc_main,{to:e.unref(b).teleportTo,disabled:e.unref(b).teleportDisabled},{default:e.withCtx((()=>[e.createVNode(e.Transition,e.mergeProps({...e.unref(b).transProps},{appear:g.value,onBeforeEnter:ae,onAfterEnter:le,onLeave:te,onAfterLeave:re}),{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("div",e.mergeProps({id:e.unref(V),ref_key:"element",ref:_,class:["modal",$.value],role:"dialog","aria-labelledby":e.unref(b).hideHeader?void 0:`${e.unref(V)}-label`,"aria-describedby":`${e.unref(V)}-body`,tabindex:"-1"},a.$attrs,{style:ie.value,onClick:l[4]||(l[4]=e.withModifiers((e=>Z("backdrop")),["self"]))}),[e.createElementVNode("div",{class:e.normalizeClass(["modal-dialog",H.value])},[q.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["modal-content",e.unref(b).contentClass])},[e.unref(b).hideHeader?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["modal-header",R.value])},[e.renderSlot(a.$slots,"header",e.normalizeProps(e.guardReactiveProps(fe.value)),(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(b).titleTag),{id:`${e.unref(V)}-label`,class:e.normalizeClass(["modal-title",W.value])},{default:e.withCtx((()=>[e.renderSlot(a.$slots,"title",e.normalizeProps(e.guardReactiveProps(fe.value)),(()=>[e.createTextVNode(e.toDisplayString(e.unref(b).title),1)]),!0)])),_:3},8,["id","class"])),e.unref(b).hideHeaderClose?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[j.value?(e.openBlock(),e.createBlock(r._sfc_main,e.mergeProps({key:0},I.value,{onClick:l[0]||(l[0]=e=>Z("close"))}),{default:e.withCtx((()=>[e.renderSlot(a.$slots,"header-close",{},void 0,!0)])),_:3},16)):(e.openBlock(),e.createBlock(n._sfc_main,e.mergeProps({key:1,"aria-label":e.unref(b).headerCloseLabel},I.value,{onClick:l[1]||(l[1]=e=>Z("close"))}),null,16,["aria-label"]))],64))]),!0)],2)),e.createElementVNode("div",e.mergeProps({id:`${e.unref(V)}-body`,class:["modal-body",A.value]},e.unref(b).bodyAttrs),[e.renderSlot(a.$slots,"default",e.normalizeProps(e.guardReactiveProps(fe.value)),(()=>[e.createTextVNode(e.toDisplayString(e.unref(b).body),1)]),!0)],16,m),e.unref(b).hideFooter?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["modal-footer",U.value])},[e.renderSlot(a.$slots,"footer",e.normalizeProps(e.guardReactiveProps(fe.value)),(()=>[e.renderSlot(a.$slots,"cancel",e.normalizeProps(e.guardReactiveProps(fe.value)),(()=>[e.unref(b).okOnly?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(r._sfc_main,{key:0,ref_key:"cancelButton",ref:S,disabled:X.value,size:e.unref(b).buttonSize,variant:e.unref(b).cancelVariant,onClick:l[2]||(l[2]=e=>Z("cancel"))},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(b).cancelTitle),1)])),_:1},8,["disabled","size","variant"]))]),!0),e.renderSlot(a.$slots,"ok",e.normalizeProps(e.guardReactiveProps(fe.value)),(()=>[e.createVNode(r._sfc_main,{ref_key:"okButton",ref:z,disabled:Y.value,size:e.unref(b).buttonSize,variant:e.unref(b).okVariant,onClick:l[3]||(l[3]=e=>Z("ok"))},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(b).okTitle),1)])),_:1},8,["disabled","size","variant"])]),!0)]),!0)],2))],2)):e.createCommentVNode("",!0)],2),e.unref(E)?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"fallbackFocusElement",ref:x,class:e.normalizeClass(y),tabindex:"0",style:{width:"0",height:"0",overflow:"hidden"}},null,512)):e.createCommentVNode("",!0)],16,v),[[e.vShow,g.value]])])),_:3},16,["appear"]),e.unref(b).hideBackdrop?e.createCommentVNode("",!0):e.renderSlot(a.$slots,"backdrop",e.normalizeProps(e.mergeProps({key:0},fe.value)),(()=>[e.createVNode(e.Transition,{appear:g.value,onAfterEnter:J,onBeforeLeave:Q},{default:e.withCtx((()=>[g.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["modal-backdrop",{fade:!e.unref(b).noFade,show:e.unref(b).noFade}]),style:e.normalizeStyle(ce.value),onClick:l[5]||(l[5]=e=>Z("backdrop"))},null,6)):e.createCommentVNode("",!0)])),_:1},8,["appear"])]),!0)])),_:3},8,["to","disabled"]))}}),B=f._export_sfc(k,[["__scopeId","data-v-06b9d0e1"]]),b=e.defineComponent({inheritAttrs:!1,__name:"BModalOrchestrator",props:{teleportDisabled:{type:Boolean,default:!1},teleportTo:{default:"body"}},setup(l,{expose:o}){const t=l,r=a.useDefaults(t,"BModalOrchestrator"),n=p.useModalController();return o({...n}),(a,l)=>(e.openBlock(),e.createBlock(c._sfc_main,{to:e.unref(r).teleportTo,disabled:e.unref(r).teleportDisabled},{default:e.withCtx((()=>{var l;return[e.createElementVNode("div",e.mergeProps({id:"__BVID__modal-container"},a.$attrs),[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null==(l=e.unref(n).modals)?void 0:l.value,(([a,l])=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.component??B),e.mergeProps({key:a,ref_for:!0},l.props,{modelValue:l.props._modelValue,"onUpdate:modelValue":[e=>l.props._modelValue=e,l=>{var o,t;return null==(t=(o=e.unref(n)).leave)?void 0:t.call(o,a)}],"teleport-disabled":!0,onHide:e=>{if(!0===l.props._isConfirm){if("ok"===e.trigger)return void l.props._promise.resolve(!0);if("cancel"===e.trigger)return void l.props._promise.resolve(!1);l.props._promise.resolve(null)}l.props._promise.resolve(!0)},onHidden:l=>{var o,t;return null==(t=(o=e.unref(n)).remove)?void 0:t.call(o,a)}}),null,16,["modelValue","onUpdate:modelValue","onHide","onHidden"])))),128))],16)]})),_:1},8,["to","disabled"]))}});exports.BModal=B,exports._sfc_main=b;
//# sourceMappingURL=BModalOrchestrator.vue_vue_type_script_setup_true_lang-Bf-q22fr.js.map
